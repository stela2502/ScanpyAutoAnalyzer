---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.12.0
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

This is likely useless. Ignore this file!
```
```

# This is is all based on a Chatty Scholar GPT 'discussion':


which cell types does a human lung contain - excluding the blood vessels and immune cells?
GPT

The human lung contains various specialized cell types that perform essential functions related to respiration, gas exchange, and tissue maintenance. Excluding blood vessels and immune cells, the main cell types in the lung include:
1. Epithelial Cells:

    Alveolar Type I Cells (Pneumocytes Type I): These are flat, thin cells that cover about 95% of the alveolar surface area and are responsible for the majority of gas exchange.
    Alveolar Type II Cells (Pneumocytes Type II): These cuboidal cells secrete pulmonary surfactant, which reduces surface tension and prevents alveolar collapse. They can also differentiate into Type I cells.
    Ciliated Epithelial Cells: Found in the airways (trachea, bronchi, bronchioles), these cells have hair-like structures called cilia that help move mucus and trapped particles out of the lungs.
    Goblet Cells: These mucus-producing cells are located in the airway epithelium and play a role in trapping and clearing inhaled particles and pathogens.
    Club Cells (Clara Cells): Found in the bronchioles, these cells secrete protective proteins and detoxify harmful substances inhaled into the lungs.

2. Mesenchymal Cells:

    Fibroblasts: These cells produce extracellular matrix components like collagen and elastin, which provide structural support to lung tissue.
    Myofibroblasts: A specialized type of fibroblast involved in tissue repair and remodeling, particularly during wound healing and in response to injury.

3. Endothelial Cells (Specific to Respiratory System):

    Pulmonary Endothelial Cells: Though these are part of the vascular system, within the context of the lungâ€™s structure, they line the capillaries of the alveoli and are crucial for the exchange of gases.

4. Smooth Muscle Cells:

    Found in the walls of the bronchi and bronchioles, these cells help regulate airway diameter by contracting or relaxing in response to various stimuli, thus controlling airflow.

5. Pericytes:

    Associated with capillaries, these cells play a role in maintaining the structural integrity of blood vessels and may influence the development and repair of lung tissue.

6. Nerve Cells:

    Sensory and Autonomic Neurons: These cells are involved in the reflexes that control breathing, bronchoconstriction, and cough response.

These cells work together to maintain lung function, allowing for efficient gas exchange while protecting the respiratory system from damage and infection.

Handling multiple papers?

Our AI sidebar -- Sider assists you skim through papers 10X faster using its 10+ one-click research tools like deep reader, advanced search, ChatPDF, and context selection.
Get ready for a smarter academic experience!
Cool - can you give me a list of 4 marker genes per cell type that could be detected in single cell sequencing - meaning they have a stable and high RNA could in the marked cells?
GPT

Here is a list of marker genes for each major lung cell type, suitable for detection in single-cell RNA sequencing. These markers are typically characterized by stable and high RNA expression levels in the respective cells:
1. Alveolar Type I Cells (Pneumocytes Type I)

    AQP5 (Aquaporin 5)
    PDPN (Podoplanin)
    AGER (Advanced Glycosylation End-Product Specific Receptor)
    HOPX (HOP Homeobox)

2. Alveolar Type II Cells (Pneumocytes Type II)

    SFTPC (Surfactant Protein C)
    SFTPB (Surfactant Protein B)
    ABCA3 (ATP Binding Cassette Subfamily A Member 3)
    NAPSA (Napsin A Aspartic Peptidase)

3. Ciliated Epithelial Cells

    FOXJ1 (Forkhead Box J1)
    CCDC39 (Coiled-Coil Domain Containing 39)
    RSPH1 (Radial Spoke Head 1 Homolog)
    DNAH5 (Dynein Axonemal Heavy Chain 5)

4. Goblet Cells

    MUC5AC (Mucin 5AC)
    MUC5B (Mucin 5B)
    SPDEF (SAM Pointed Domain Containing ETS Transcription Factor)
    TFF3 (Trefoil Factor 3)

5. Club Cells (Clara Cells)

    SCGB1A1 (Secretoglobin Family 1A Member 1, also known as CC10 or CCSP)
    SCGB3A2 (Secretoglobin Family 3A Member 2)
    CYP2F1 (Cytochrome P450 Family 2 Subfamily F Member 1)
    KRT5 (Keratin 5)

6. Fibroblasts

    COL1A1 (Collagen Type I Alpha 1 Chain)
    FN1 (Fibronectin 1)
    ACTA2 (Actin Alpha 2, Smooth Muscle)
    PDGFRA (Platelet Derived Growth Factor Receptor Alpha)

7. Myofibroblasts

    ACTA2 (Actin Alpha 2, Smooth Muscle)
    TAGLN (Transgelin)
    COL1A2 (Collagen Type I Alpha 2 Chain)
    VIM (Vimentin)

8. Smooth Muscle Cells

    ACTA2 (Actin Alpha 2, Smooth Muscle)
    MYH11 (Myosin Heavy Chain 11)
    CNN1 (Calponin 1)
    TAGLN (Transgelin)

9. Pulmonary Endothelial Cells

    PECAM1 (Platelet And Endothelial Cell Adhesion Molecule 1)
    VWF (Von Willebrand Factor)
    ICAM2 (Intercellular Adhesion Molecule 2)
    CDH5 (Cadherin 5, also known as VE-cadherin)

10. Pericytes

    PDGFRB (Platelet Derived Growth Factor Receptor Beta)
    RGS5 (Regulator Of G-Protein Signaling 5)
    ACTA2 (Actin Alpha 2, Smooth Muscle)
    MCAM (Melanoma Cell Adhesion Molecule)

These markers are well-established for their roles in identifying and characterizing specific lung cell types in single-cell RNA sequencing experiments.
The nerve cells do not get a gene list? Or is this more compilcated and the nerve cells actually split up into several subsets and therefore you can not give me this info?
GPT

Nerve cells in the lung indeed comprise several subtypes with distinct functions, which makes it more complicated to list a single set of marker genes for all nerve cells. In the lung, nerve cells can be categorized into various types, such as sensory neurons, autonomic neurons (including sympathetic and parasympathetic neurons), and enteric neurons.
Subtypes of Nerve Cells and Their Marker Genes:
1. Sensory Neurons:

    TRPV1 (Transient Receptor Potential Cation Channel Subfamily V Member 1): Involved in sensing pain and temperature.
    SCN10A (Sodium Voltage-Gated Channel Alpha Subunit 10): A sodium channel important for action potential generation.
    NTRK1 (Neurotrophic Receptor Tyrosine Kinase 1, also known as TrkA): Receptor for nerve growth factor (NGF).
    CALCA (Calcitonin-Related Polypeptide Alpha): Encodes the neuropeptide CGRP, involved in pain transmission.

2. Autonomic Neurons (Parasympathetic and Sympathetic Neurons):

    CHAT (Choline O-Acetyltransferase): Marker for cholinergic neurons, involved in acetylcholine synthesis.
    TH (Tyrosine Hydroxylase): Marker for sympathetic neurons, involved in catecholamine synthesis.
    VIP (Vasoactive Intestinal Peptide): Found in parasympathetic neurons, involved in smooth muscle relaxation.
    NOS1 (Nitric Oxide Synthase 1): Involved in neurotransmission, particularly in non-adrenergic, non-cholinergic (NANC) neurons.

3. Enteric Neurons:

    RET (Rearranged During Transfection): A receptor tyrosine kinase involved in development and function of enteric neurons.
    S100B (S100 Calcium Binding Protein B): Commonly found in glial cells and enteric glial cells.
    PHOX2B (Paired-Like Homeobox 2B): A transcription factor essential for autonomic nervous system development.
    EDNRB (Endothelin Receptor Type B): Involved in neural crest cell development, including enteric neurons.

Challenges in Assigning Marker Genes for Lung Nerve Cells:

    Diversity: Nerve cells are highly diverse, and each subtype expresses a unique combination of genes that may overlap with other subtypes.
    Spatial Distribution: Nerve cells are spread throughout the lung, innervating different regions with different functions, leading to varied gene expression profiles.
    Functional Specialization: Different nerve cells are involved in diverse physiological processes (e.g., sensing, regulating airway tone, responding to chemical stimuli), each requiring specific markers.

Given the complexity and heterogeneity of nerve cells in the lung, the above lists are not exhaustive but represent key marker genes commonly used to identify these cell types in single-cell RNA sequencing studies.

```python
%load_ext autotime

import scvelo as scv
import loompy
import scanpy
import igraph
import phate
import glob, os
import pandas as pd
import re
import subprocess
from collections import Counter
import numpy as np
from shutil import rmtree
import anndata

import h5py
from shutil import copyfile

print('\n'.join(f'{m.__name__}=={m.__version__}' for m in globals().values() if getattr(m, '__version__', None)))

```

```python

ifile="MyCoolData.h5ad"
```

```python

adata = anndata.read( ifile )

```

```python

from collections import defaultdict

lung_cell_markers = defaultdict(list)

# Alveolar Type I Cells
lung_cell_markers['Alveolar Type I Cells'] = ['AQP5', 'PDPN', 'AGER', 'HOPX']

# Alveolar Type II Cells
lung_cell_markers['Alveolar Type II Cells'] = ['SFTPC', 'SFTPB', 'ABCA3', 'NAPSA']

# Ciliated Epithelial Cells
lung_cell_markers['Ciliated Epithelial Cells'] = ['FOXJ1', 'CCDC39', 'RSPH1', 'DNAH5']

# Goblet Cells
lung_cell_markers['Goblet Cells'] = ['MUC5AC', 'MUC5B', 'SPDEF', 'TFF3']

# Club Cells
lung_cell_markers['Club Cells'] = ['SCGB1A1', 'SCGB3A2', 'CYP2F1', 'KRT5']

# Fibroblasts
lung_cell_markers['Fibroblasts'] = ['COL1A1', 'FN1', 'ACTA2', 'PDGFRA']

# Myofibroblasts
lung_cell_markers['Myofibroblasts'] = ['ACTA2', 'TAGLN', 'COL1A2', 'VIM']

# Smooth Muscle Cells
lung_cell_markers['Smooth Muscle Cells'] = ['ACTA2', 'MYH11', 'CNN1', 'TAGLN']

# Pulmonary Endothelial Cells
lung_cell_markers['Pulmonary Endothelial Cells'] = ['PECAM1', 'VWF', 'ICAM2', 'CDH5']

# Pericytes
lung_cell_markers['Pericytes'] = ['PDGFRB', 'RGS5', 'ACTA2', 'MCAM']

# Sensory Neurons
lung_cell_markers['Sensory Neurons'] = ['TRPV1', 'SCN10A', 'NTRK1', 'CALCA']

# Autonomic Neurons
lung_cell_markers['Autonomic Neurons'] = ['CHAT', 'TH', 'VIP', 'NOS1']

# Enteric Neurons
lung_cell_markers['Enteric Neurons'] = ['RET', 'S100B', 'PHOX2B', 'EDNRB']

# Filter out cell types with no detectable marker genes in the dataset
detected_markers = defaultdict(list)

for cell_type, markers in lung_cell_markers.items():
    detected_genes = [gene for gene in markers if gene in adata.var_names]
    if detected_genes:
        detected_markers[cell_type] = detected_genes

```

```python
scanpy.pl.dotplot(adata, detected_genes, groupby='louvain', dendrogram=True)
```


```python
import matplotlib.pyplot as plt

def scale_values(row):
    total_sum = sum(row)
    scaled_values = {key: value * 100 / total_sum for key, value in row.items()}
    return scaled_values

sname_tab = adata.obs.pivot_table(values = "n_genes", index = "louvain", columns="sname", aggfunc='count')
sname_tab_scaled = sname_tab.apply( scale_values, axis=1,  result_type='expand')
ax = sname_tab_scaled.plot.bar(stacked=True, figsize=(16, 8))
ax.legend(loc='center left', bbox_to_anchor=(1, 0.5))
plt.savefig('sname_vs_louvain_stacked_bar_plot.svg', format='svg', bbox_inches='tight')
plt.show()
```
